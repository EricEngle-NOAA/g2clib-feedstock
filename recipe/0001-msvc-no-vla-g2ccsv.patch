diff --git a/src/g2ccsv.c b/src/g2ccsv.c
index 0000000..0000000 100644
--- a/src/g2ccsv.c
+++ b/src/g2ccsv.c
@@ -1,6 +1,12 @@
 #include "grib2_int.h"
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
+
+/* MSVC does not support C variable-length arrays (VLA). Use a compile-time
+ * constant for line buffers. */
+#ifndef G2C_CSV_MAX_LINE_SIZE
+#define G2C_CSV_MAX_LINE_SIZE 500
+#endif

@@ -176,12 +182,11 @@ int
 g2c_csv_init()
 {
-    const int max_line_size = 500;
     const int num_columns = 9;
     int i;
     char *buf, *tmp, *key;
-    char line[max_line_size];
+    char line[G2C_CSV_MAX_LINE_SIZE];
     G2C_CODE_TABLE_T *my_table = NULL;
     G2C_CODE_ENTRY_T *new_entry = NULL;

@@ -196,10 +201,10 @@ g2c_csv_init()
         return G2C_ECSV;

     /* Skip header line */
-    buf = fgets(line, max_line_size, doc);
+    buf = fgets(line, G2C_CSV_MAX_LINE_SIZE, doc);

     /* Go through the document and save table data.
      * Each line is a table of codes. */
-    while ((buf = fgets(line, max_line_size, doc)) != NULL)
+    while ((buf = fgets(line, G2C_CSV_MAX_LINE_SIZE, doc)) != NULL)
     {
         i = 0;
         while (buf != NULL && i < num_columns)
