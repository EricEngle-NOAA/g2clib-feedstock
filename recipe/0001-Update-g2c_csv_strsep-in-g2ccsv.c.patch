From 3e32ad9377b411c88a292b0a9c5bea3500b9538c Mon Sep 17 00:00:00 2001
From: Eric Engle <EricEngle-NOAA@users.noreply.github.com>
Date: Thu, 27 Feb 2025 10:17:40 -0500
Subject: [PATCH] Update g2c_csv_strsep in g2ccsv.c

Re-worked logic that works on Microsoft Visual C++ compiler.
---
 src/g2ccsv.c | 18 +++++++++++-------
 1 file changed, 11 insertions(+), 7 deletions(-)

diff --git a/src/g2ccsv.c b/src/g2ccsv.c
index 54f7415..906177e 100644
--- a/src/g2ccsv.c
+++ b/src/g2ccsv.c
@@ -191,15 +191,19 @@ g2c_find_entry(char *desc, G2C_CODE_TABLE_T *table)
 static char *
 g2c_csv_strsep(char **stringp, const char *delim)
 {
+    if (!stringp || !*stringp)
+        return NULL;
+
     char *rv = *stringp;
-    if (rv)
-    {
-        *stringp += strcspn(*stringp, delim);
-        if (**stringp)
-            *(*stringp)++ = '\0';
-        else
-            *stringp = 0;
+    *stringp += strcspn(*stringp, delim);
+
+    if (**stringp) {
+        **stringp = '\0';
+        (*stringp)++;
+    } else {
+        *stringp = NULL;
     }
+
     return rv;
 }
 
-- 
2.39.5 (Apple Git-154)

